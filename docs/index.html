<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python„Ç≤„Éº„É†ÈñãÁô∫ „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÂ≠¶ÁøíÁí∞Â¢É</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeIn 1s ease-in;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .user-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            backdrop-filter: blur(10px);
        }

        .level-badge {
            display: inline-block;
            background: #ffd700;
            color: #333;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            margin-left: 10px;
        }

        .xp-bar {
            width: 200px;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .xp-progress {
            height: 100%;
            background: #4caf50;
            transition: width 0.5s ease;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .sidebar {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .chapter-list {
            list-style: none;
        }

        .chapter-item {
            padding: 10px;
            margin: 5px 0;
            background: #f5f5f5;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .chapter-item:hover {
            background: #e3f2fd;
            transform: translateX(5px);
        }

        .chapter-item.active {
            background: #667eea;
            color: white;
        }

        .chapter-item.completed::after {
            content: '‚úì';
            position: absolute;
            right: 10px;
            color: #4caf50;
            font-weight: bold;
            font-size: 18px;
        }

        .chapter-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chapter-item.locked::after {
            content: 'üîí';
            position: absolute;
            right: 10px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideUp 0.5s ease-out;
        }

        .card.full-width {
            grid-column: 1 / -1;
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .lesson-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .difficulty-indicator {
            display: flex;
            gap: 5px;
        }

        .difficulty-star {
            font-size: 20px;
            color: #ddd;
        }

        .difficulty-star.active {
            color: #ffd700;
        }

        .code-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .code-tab {
            padding: 10px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
            font-size: 14px;
        }

        .code-tab:hover {
            background: #f5f5f5;
        }

        .code-tab.active {
            color: #667eea;
            font-weight: bold;
        }

        .code-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #667eea;
        }

        .code-editor-wrapper {
            position: relative;
            margin-bottom: 15px;
            display: flex;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: #f0f0f0;
        }

        .line-numbers {
            background: #f0f0f0;
            padding: 15px 10px;
            color: #999;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 21px;
            user-select: none;
            text-align: right;
            min-width: 45px;
            width: 45px;
            border-right: 1px solid #e0e0e0;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº„ÇíÈùûË°®Á§∫ */
        .line-numbers::-webkit-scrollbar {
            width: 0;
            display: none;
        }

        .code-editor {
            flex: 1;
            min-height: 300px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border: none;
            background: #f8f8f8;
            resize: none; /* flexbox„É¨„Ç§„Ç¢„Ç¶„Éà„ÅÆ„Åü„ÇÅ„ÄÅ„É™„Çµ„Ç§„Ç∫„ÇíÁÑ°ÂäπÂåñ */
            line-height: 21px;
            tab-size: 4;
            outline: none;
            overflow-y: auto;
        }

        .code-editor-wrapper:focus-within {
            border-color: #667eea;
        }

        .code-editor-wrapper:focus-within .code-editor {
            background: white;
        }

        .comparison-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .comparison-box {
            padding: 15px;
            border-radius: 8px;
            background: #f5f5f5;
        }

        .comparison-box.scratch {
            background: #ffeb3b1a;
            border: 2px solid #ffc107;
        }

        .comparison-box.python {
            background: #4caf501a;
            border: 2px solid #4caf50;
        }

        .comparison-box h4 {
            margin-bottom: 10px;
            color: #555;
        }

        .comparison-box pre {
            margin: 0;
            font-size: 13px;
        }

        .visual-explanation {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .memory-visualization {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .memory-box {
            background: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            min-width: 120px;
            text-align: center;
            animation: fadeIn 0.5s;
            transition: all 0.3s;
        }

        .memory-box.highlight {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .memory-box .var-name {
            color: #667eea;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .memory-box .var-value {
            font-size: 1.2em;
            font-family: monospace;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-primary {
            background: #4caf50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .btn-secondary {
            background: #fbc02d;
            color: #333;
        }

        .btn-secondary:hover {
            background: #f9a825;
            box-shadow: 0 5px 15px rgba(251, 192, 45, 0.3);
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-danger:hover {
            background: #da190b;
        }

        .output-area {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 8px;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-y: auto;
            max-height: 400px;
            line-height: 1.5;
        }

        .output-area.error {
            color: #ff5252;
        }

        .output-area .input-prompt {
            color: #64b5f6;
        }

        .output-area .output-line {
            margin: 2px 0;
        }

        .hint-system {
            margin-top: 20px;
        }

        .hint-level {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .hint-button {
            flex: 1;
            padding: 10px;
            background: #e0e0e0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .hint-button:hover:not(.revealed) {
            background: #fbc02d;
        }

        .hint-button.revealed {
            background: #4caf50;
            color: white;
        }

        .hint-content {
            background: #fff9c4;
            border-left: 4px solid #fbc02d;
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
            display: none;
        }

        .hint-content.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        .test-cases {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        .test-case {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            margin: 8px 0;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .test-case.pass {
            background: #e8f5e9;
            border-left: 3px solid #4caf50;
        }

        .test-case.fail {
            background: #ffebee;
            border-left: 3px solid #f44336;
        }

        .test-case.pending {
            background: #fff;
            border-left: 3px solid #ddd;
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 1000;
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .achievement-popup.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .achievement-icon {
            font-size: 60px;
            margin-bottom: 15px;
            animation: bounce 0.5s;
        }

        .achievement-title {
            font-size: 24px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .achievement-desc {
            color: #666;
            margin-bottom: 20px;
        }

        .achievement-xp {
            color: #4caf50;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .challenge-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .challenge-list {
            list-style: none;
            margin-top: 15px;
        }

        .challenge-item {
            padding: 12px;
            background: rgba(255,255,255,0.1);
            margin: 8px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .challenge-item:hover {
            background: rgba(255,255,255,0.2);
        }

        .challenge-item.completed {
            background: rgba(76, 175, 80, 0.3);
        }

        .challenge-item.completed::before {
            content: '‚úì ';
            color: #4caf50;
            font-weight: bold;
        }

        .debug-panel {
            margin-top: 15px;
            padding: 15px;
            background: #2d2d2d;
            border-radius: 8px;
            color: #f0f0f0;
            font-family: monospace;
            font-size: 12px;
            max-height: 150px;
            overflow-y: auto;
        }

        .debug-line {
            margin: 2px 0;
            padding: 2px 5px;
        }

        .debug-line.step {
            color: #64b5f6;
        }

        .debug-line.variable {
            color: #ffb74d;
        }

        .debug-line.error {
            color: #e57373;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .stat-box {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: 2;
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }

            .user-info {
                position: static;
                margin-bottom: 20px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± -->
    <div class="user-info">
        <span id="userName">„Éó„É¨„Ç§„É§„Éº</span>
        <span class="level-badge">Lv.<span id="userLevel">1</span></span>
        <div class="xp-bar">
            <div class="xp-progress" id="xpProgress" style="width: 0%"></div>
        </div>
        <small><span id="currentXP">0</span> / <span id="requiredXP">100</span> XP</small>
    </div>

    <div class="container">
        <div class="header">
            <h1>üéÆ Python„Ç≤„Éº„É†ÈñãÁô∫Â≠¶ÁøíÁí∞Â¢É</h1>
            <p>Scratch„Åã„ÇâPython„Å∏„ÄÅÊ•Ω„Åó„Åè„Çπ„ÉÜ„ÉÉ„Éó„Ç¢„ÉÉ„ÉóÔºÅ</p>
        </div>

        <div class="main-layout">
            <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
            <aside class="sidebar">
                <h3 style="margin-bottom: 15px;">üìö „ÉÅ„É£„Éó„Çø„Éº</h3>
                <ul class="chapter-list" id="chapterList">
                    <li class="chapter-item active" data-chapter="0">0. Êû∂„ÅëÊ©ã</li>
                    <li class="chapter-item" data-chapter="1">1. Â§âÊï∞„Å®Âûã</li>
                    <li class="chapter-item" data-chapter="2">2. Êù°‰ª∂ÂàÜÂ≤ê</li>
                    <li class="chapter-item" data-chapter="3">3. Áπ∞„ÇäËøî„Åó</li>
                    <li class="chapter-item locked" data-chapter="4">4. „É™„Çπ„Éà</li>
                    <li class="chapter-item locked" data-chapter="5">5. Èñ¢Êï∞</li>
                </ul>

                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-value" id="completedCount">0</div>
                        <div class="stat-label">ÂÆå‰∫Ü„É¨„ÉÉ„Çπ„É≥</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="streakCount">0</div>
                        <div class="stat-label">ÈÄ£Á∂öÊó•Êï∞</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="totalTime">0</div>
                        <div class="stat-label">Â≠¶ÁøíÊôÇÈñì(ÂàÜ)</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="errorsSolved">0</div>
                        <div class="stat-label">Ëß£Ê±∫„Ç®„É©„Éº</div>
                    </div>
                </div>
            </aside>

            <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
            <div class="main-content">
                <!-- „É¨„ÉÉ„Çπ„É≥„Ç®„É™„Ç¢ -->
                <div class="card">
                    <div class="lesson-header">
                        <h2 id="lessonTitle">üìö „É¨„ÉÉ„Çπ„É≥1: Â§âÊï∞„ÇíÁêÜËß£„Åó„Çà„ÅÜ</h2>
                        <div class="difficulty-indicator">
                            <span class="difficulty-star active">‚≠ê</span>
                            <span class="difficulty-star">‚≠ê</span>
                            <span class="difficulty-star">‚≠ê</span>
                        </div>
                    </div>

                    <!-- Scratch vs Python ÊØîËºÉ -->
                    <div class="comparison-view" id="comparisonView">
                        <div class="comparison-box scratch">
                            <h4>üü® Scratch„ÅÆÂ†¥Âêà</h4>
                            <pre><code id="scratchCode">[Â§âÊï∞„Çí‰Ωú„Çã] ‚Üí score
[score„Çí0„Å´„Åô„Çã]
[score„Çí1„Åö„Å§Â§â„Åà„Çã]</code></pre>
                        </div>
                        <div class="comparison-box python">
                            <h4>üêç Python„ÅÆÂ†¥Âêà</h4>
                            <pre><code id="pythonCode">score = 0
score = score + 1
print(score)</code></pre>
                        </div>
                    </div>

                    <!-- „Éì„Ç∏„É•„Ç¢„É´Ë™¨Êòé -->
                    <div class="visual-explanation" id="visualExplanation">
                        <h4>üí° „É°„É¢„É™„ÅÆ‰∏≠„Åß‰Ωï„ÅåËµ∑„Åç„Å¶„ÅÑ„Çã„ÅãÔºü</h4>
                        <div class="memory-visualization" id="memoryViz">
                            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                        </div>
                    </div>

                    <!-- „Ç≥„Éº„Éâ„Ç®„Éá„Ç£„Çø -->
                    <div class="code-tabs">
                        <button class="code-tab active" onclick="switchTab('practice')">Á∑¥ÁøíÂïèÈ°å</button>
                        <button class="code-tab" onclick="switchTab('solution')">Ëß£Á≠î‰æã</button>
                        <button class="code-tab" onclick="switchTab('sandbox')">Ëá™Áî±„Å´Ë©¶„Åô</button>
                    </div>

                    <div class="code-editor-wrapper">
                        <div class="line-numbers" id="lineNumbers">1</div>
                        <textarea id="codeEditor" class="code-editor" placeholder="„Åì„Åì„Å´„Ç≥„Éº„Éâ„ÇíÂÖ•Âäõ..."></textarea>
                    </div>

                    <!-- „Éí„É≥„Éà„Ç∑„Çπ„ÉÜ„É† -->
                    <div class="hint-system">
                        <div class="hint-level">
                            <button class="hint-button" onclick="showHint(1)">üí° „Éí„É≥„Éà1</button>
                            <button class="hint-button" onclick="showHint(2)">üí° „Éí„É≥„Éà2</button>
                            <button class="hint-button" onclick="showHint(3)">üí° Á≠î„Åà„ÇíË¶ã„Çã</button>
                        </div>
                        <div id="hintContent" class="hint-content"></div>
                    </div>

                    <!-- ÂÆüË°å„Éú„Çø„É≥ -->
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="runCode()">
                            ‚ñ∂Ô∏è ÂÆüË°å
                        </button>
                        <button class="btn btn-secondary" onclick="stepDebug()">
                            üêõ „Çπ„ÉÜ„ÉÉ„ÉóÂÆüË°å
                        </button>
                        <button class="btn btn-secondary" onclick="checkCode()">
                            ‚úì Á≠î„ÅàÂêà„Çè„Åõ
                        </button>
                        <button class="btn btn-danger" onclick="resetCode()">
                            üîÑ „É™„Çª„ÉÉ„Éà
                        </button>
                    </div>

                    <!-- „ÉÜ„Çπ„Éà„Ç±„Éº„Çπ -->
                    <div class="test-cases" id="testCases" style="display: none;">
                        <h4>üìù „ÉÜ„Çπ„ÉàÁµêÊûú</h4>
                        <div id="testResults"></div>
                    </div>
                </div>

                <!-- Âá∫Âäõ„Ç®„É™„Ç¢ -->
                <div class="card">
                    <h2>üíª ÂÆüË°åÁµêÊûú</h2>
                    <div id="output" class="output-area">ÂÆüË°åÁµêÊûú„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô...</div>
                    
                    <!-- „Éá„Éê„ÉÉ„Ç∞„Éë„Éç„É´ -->
                    <div class="debug-panel" id="debugPanel" style="display: none;">
                        <div id="debugOutput"></div>
                    </div>
                </div>

                <!-- „ÉÅ„É£„É¨„É≥„Ç∏Ë™≤È°å -->
                <div class="card full-width">
                    <div class="challenge-card">
                        <h3>üéØ ‰ªäÊó•„ÅÆ„ÉÅ„É£„É¨„É≥„Ç∏</h3>
                        <p>‰ª•‰∏ã„ÅÆË™≤È°å„Çí„ÇØ„É™„Ç¢„Åó„Å¶„ÄÅ„Éú„Éº„Éä„ÇπXP„ÇíÁç≤Âæó„Åó„Çà„ÅÜÔºÅ</p>
                        <ul class="challenge-list" id="challengeList">
                            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂÆüÁ∏æ„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó -->
    <div id="achievementPopup" class="achievement-popup">
        <div class="achievement-icon">üèÜ</div>
        <div class="achievement-title" id="achievementTitle">ÂÆüÁ∏æËß£Èô§ÔºÅ</div>
        <div class="achievement-desc" id="achievementDesc">Âàù„ÇÅ„Å¶„ÅÆ„Éó„É≠„Ç∞„É©„É†„ÇíÂÆüË°å„Åó„Åæ„Åó„Åü</div>
        <div class="achievement-xp" id="achievementXP">+50 XP</div>
        <button class="btn btn-primary" onclick="closeAchievement()">OK</button>
    </div>

    <script>
        // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
        let currentLesson = 0;
        let currentTab = 'practice';
        let executionStep = 0;
        let variables = {};
        let userProgress = {
            level: 1,
            xp: 0,
            requiredXP: 100,
            completedLessons: [],
            achievements: [],
            totalTime: 0,
            errorsSolved: 0,
            streak: 0
        };

        // „É¨„ÉÉ„Çπ„É≥„Éá„Éº„Çø
        const lessons = [
            {
                id: 0,
                title: "„É¨„ÉÉ„Çπ„É≥1: Â§âÊï∞„ÇíÁêÜËß£„Åó„Çà„ÅÜ",
                difficulty: 1,
                scratch: "[Â§âÊï∞„Çí‰Ωú„Çã] ‚Üí score\n[score„Çí0„Å´„Åô„Çã]\n[score„Çí1„Åö„Å§Â§â„Åà„Çã]",
                python: "score = 0\nscore = score + 1\nprint(score)",
                practice: `# Â§âÊï∞„ÅÆÁ∑¥Áøí
# score„Å®„ÅÑ„ÅÜÂ§âÊï∞„Çí‰Ωú„Å£„Å¶0„ÇíÂÖ•„Çå„Çà„ÅÜ
score = ___

# score„ÇíË°®Á§∫„Åó„Çà„ÅÜ
print("ÁèæÂú®„ÅÆ„Çπ„Ç≥„Ç¢:", ___)

# score„Å´1„ÇíË∂≥„Åù„ÅÜ
score = score + ___

# Êñ∞„Åó„ÅÑscore„ÇíË°®Á§∫„Åó„Çà„ÅÜ
print("Êñ∞„Åó„ÅÑ„Çπ„Ç≥„Ç¢:", score)`,
                solution: `# Â§âÊï∞„ÅÆÁ∑¥Áøí
# score„Å®„ÅÑ„ÅÜÂ§âÊï∞„Çí‰Ωú„Å£„Å¶0„ÇíÂÖ•„Çå„Çà„ÅÜ
score = 0

# score„ÇíË°®Á§∫„Åó„Çà„ÅÜ
print("ÁèæÂú®„ÅÆ„Çπ„Ç≥„Ç¢:", score)

# score„Å´1„ÇíË∂≥„Åù„ÅÜ
score = score + 1

# Êñ∞„Åó„ÅÑscore„ÇíË°®Á§∫„Åó„Çà„ÅÜ
print("Êñ∞„Åó„ÅÑ„Çπ„Ç≥„Ç¢:", score)`,
                hints: [
                    "Â§âÊï∞„ÅØ„ÄåÂêçÂâç = ÂÄ§„Äç„ÅÆÂΩ¢„Åß‰Ωú„Çä„Åæ„Åô„ÄÇscore„Å´0„ÇíÂÖ•„Çå„Çã„Å´„ÅØ score = 0 „Å®Êõ∏„Åç„Åæ„Åô„ÄÇ",
                    "print()„ÅÆ‰∏≠„ÅßÂ§âÊï∞„Çí‰Ωø„ÅÜ„Å´„ÅØ„ÄÅÂ§âÊï∞Âêç„Çí„Åù„ÅÆ„Åæ„ÅæÊõ∏„Åç„Åæ„Åô„ÄÇprint(\"„ÉÜ„Ç≠„Çπ„Éà\", score)",
                    "Ê≠£Ëß£: score = 0, score, 1"
                ],
                expectedOutput: "ÁèæÂú®„ÅÆ„Çπ„Ç≥„Ç¢: 0\nÊñ∞„Åó„ÅÑ„Çπ„Ç≥„Ç¢: 1",
                challenges: [
                    { id: "var3", desc: "Â§âÊï∞„Çí3„Å§‰ª•‰∏ä‰Ωø„ÅÜ", xp: 20 },
                    { id: "noerror", desc: "„Ç®„É©„Éº„Å™„Åó„ÅßÂÆüË°å", xp: 10 },
                    { id: "original", desc: "„Ç™„É™„Ç∏„Éä„É´Â§âÊï∞„ÇíËøΩÂä†", xp: 30 }
                ]
            },
            {
                id: 1,
                title: "„É¨„ÉÉ„Çπ„É≥2: ÂÖ•Âá∫Âäõ„Çí„Éû„Çπ„Çø„Éº",
                difficulty: 1,
                scratch: "[„Äú„Å®ËÅû„ÅÑ„Å¶ÂæÖ„Å§]\n[Á≠î„Åà]",
                python: "name = input('ÂêçÂâç„ÅØÔºü')\nprint('„Åì„Çì„Å´„Å°„ÅØ', name)",
                practice: `# ÂÖ•Âá∫Âäõ„ÅÆÁ∑¥Áøí
# ÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„ÇÇ„Çâ„Åä„ÅÜ
name = ___("„ÅÇ„Å™„Åü„ÅÆÂêçÂâç„ÅØÔºü ")

# Êå®Êã∂„ÇíË°®Á§∫„Åó„Çà„ÅÜ
print("„Åì„Çì„Å´„Å°„ÅØ„ÄÅ___„Åï„ÇìÔºÅ")

# Êï∞ÂÄ§„ÅÆÂÖ•Âäõ
age_str = input("Âπ¥ÈΩ¢„ÅØÔºü ")
age = ___(age_str)  # ÊñáÂ≠ó„ÇíÊï∞ÂÄ§„Å´Â§âÊèõ

print("5Âπ¥Âæå„ÅØ", age + ___, "Ê≠≥„Åß„Åô„Å≠ÔºÅ")`,
                solution: `# ÂÖ•Âá∫Âäõ„ÅÆÁ∑¥Áøí
# ÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„ÇÇ„Çâ„Åä„ÅÜ
name = input("„ÅÇ„Å™„Åü„ÅÆÂêçÂâç„ÅØÔºü ")

# Êå®Êã∂„ÇíË°®Á§∫„Åó„Çà„ÅÜ
print("„Åì„Çì„Å´„Å°„ÅØ„ÄÅ" + name + "„Åï„ÇìÔºÅ")

# Êï∞ÂÄ§„ÅÆÂÖ•Âäõ
age_str = input("Âπ¥ÈΩ¢„ÅØÔºü ")
age = int(age_str)  # ÊñáÂ≠ó„ÇíÊï∞ÂÄ§„Å´Â§âÊèõ

print("5Âπ¥Âæå„ÅØ", age + 5, "Ê≠≥„Åß„Åô„Å≠ÔºÅ")`,
                hints: [
                    "input()Èñ¢Êï∞„ÅßÂÖ•Âäõ„ÇíÂèó„ÅëÂèñ„Çä„Åæ„Åô",
                    "ÊñáÂ≠óÂàó„ÇíÊï∞ÂÄ§„Å´Â§âÊèõ„Åô„Çã„Å´„ÅØ int() „Çí‰Ωø„ÅÑ„Åæ„Åô",
                    "Ê≠£Ëß£: input, name, int, 5"
                ],
                expectedOutput: "„ÅÇ„Å™„Åü„ÅÆÂêçÂâç„ÅØÔºü Â§™ÈÉé\n„Åì„Çì„Å´„Å°„ÅØ„ÄÅÂ§™ÈÉé„Åï„ÇìÔºÅ\nÂπ¥ÈΩ¢„ÅØÔºü 13\n5Âπ¥Âæå„ÅØ 18 Ê≠≥„Åß„Åô„Å≠ÔºÅ",
                challenges: [
                    { id: "multi_input", desc: "Ë§áÊï∞„ÅÆÂÖ•Âäõ„ÇíÂá¶ÁêÜ", xp: 25 },
                    { id: "type_convert", desc: "ÂûãÂ§âÊèõ„Çí‰ΩøÁî®", xp: 20 },
                    { id: "format", desc: "„Åç„Çå„ÅÑ„Å´Êï¥ÂΩ¢„Åó„Å¶Âá∫Âäõ", xp: 30 }
                ]
            },
            {
                id: 2,
                title: "„É¨„ÉÉ„Çπ„É≥3: Êù°‰ª∂ÂàÜÂ≤ê",
                difficulty: 2,
                scratch: "[„ÇÇ„Åó„Äú„Å™„Çâ]\n[„Åß„Å™„Åë„Çå„Å∞]",
                python: "if score > 10:\n    print('È´òÂæóÁÇπÔºÅ')\nelse:\n    print('È†ëÂºµ„Çç„ÅÜÔºÅ')",
                practice: `# Êù°‰ª∂ÂàÜÂ≤ê„ÅÆÁ∑¥Áøí
score = 15

# score„Å´„Çà„Å£„Å¶„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂ§â„Åà„Çã
___ score > 20:
    print("Á¥†Êô¥„Çâ„Åó„ÅÑÔºÅ")
___ score > 10:
    print("ËâØ„ÅÑ„Åß„Åô„Å≠ÔºÅ")
___:
    print("„ÇÇ„ÅÜÂ∞ë„ÅóÈ†ëÂºµ„Çç„ÅÜÔºÅ")`,
                solution: `# Êù°‰ª∂ÂàÜÂ≤ê„ÅÆÁ∑¥Áøí
score = 15

# score„Å´„Çà„Å£„Å¶„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂ§â„Åà„Çã
if score > 20:
    print("Á¥†Êô¥„Çâ„Åó„ÅÑÔºÅ")
elif score > 10:
    print("ËâØ„ÅÑ„Åß„Åô„Å≠ÔºÅ")
else:
    print("„ÇÇ„ÅÜÂ∞ë„ÅóÈ†ëÂºµ„Çç„ÅÜÔºÅ")`,
                hints: [
                    "Êù°‰ª∂ÂàÜÂ≤ê„ÅØ if, elif, else „Çí‰Ωø„ÅÑ„Åæ„Åô",
                    "Êù°‰ª∂„ÅÆÂæå„Å´„ÅØÂøÖ„Åö : („Ç≥„É≠„É≥) „ÅåÂøÖË¶Å„Åß„Åô",
                    "Ê≠£Ëß£: if, elif, else"
                ],
                expectedOutput: "ËâØ„ÅÑ„Åß„Åô„Å≠ÔºÅ",
                challenges: [
                    { id: "nested_if", desc: "ÂÖ•„ÇåÂ≠ê„ÅÆÊù°‰ª∂ÂàÜÂ≤ê", xp: 35 },
                    { id: "multi_cond", desc: "Ë§áÊï∞Êù°‰ª∂„ÇíÁµÑ„ÅøÂêà„Çè„Åõ", xp: 30 },
                    { id: "grade", desc: "ÊàêÁ∏æÂà§ÂÆö„Éó„É≠„Ç∞„É©„É†‰ΩúÊàê", xp: 40 }
                ]
            },
            {
                id: 3,
                title: "„É¨„ÉÉ„Çπ„É≥4: Áπ∞„ÇäËøî„ÅóÂá¶ÁêÜ",
                difficulty: 2,
                scratch: "[10ÂõûÁπ∞„ÇäËøî„Åô]",
                python: "for i in range(10):\n    print(i)",
                practice: `# Áπ∞„ÇäËøî„Åó„ÅÆÁ∑¥Áøí
# 1„Åã„Çâ5„Åæ„ÅßÊï∞„Åà„Çã
___ i in ___(1, 6):
    print(i)

# „Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥
print("„Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ÈñãÂßãÔºÅ")
for i in range(___, ___, -1):
    print(i)
print("Áô∫Â∞ÑÔºÅ")`,
                solution: `# Áπ∞„ÇäËøî„Åó„ÅÆÁ∑¥Áøí
# 1„Åã„Çâ5„Åæ„ÅßÊï∞„Åà„Çã
for i in range(1, 6):
    print(i)

# „Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥
print("„Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ÈñãÂßãÔºÅ")
for i in range(3, 0, -1):
    print(i)
print("Áô∫Â∞ÑÔºÅ")`,
                hints: [
                    "forÊñá„ÅßÁπ∞„ÇäËøî„Åó„Çí‰Ωú„Çä„Åæ„Åô„ÄÇrange(ÈñãÂßã, ÁµÇ‰∫Ü) „ÅßÁØÑÂõ≤„ÇíÊåáÂÆö",
                    "range(3, 0, -1) „ÅØ 3„Åã„Çâ1„Åæ„ÅßÈÄÜÈ†Ü„Å´Êï∞„Åà„Åæ„Åô",
                    "Ê≠£Ëß£: for, range, 3, 0"
                ],
                expectedOutput: "1\n2\n3\n4\n5\n„Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ÈñãÂßãÔºÅ\n3\n2\n1\nÁô∫Â∞ÑÔºÅ",
                challenges: [
                    { id: "nested_loop", desc: "‰∫åÈáç„É´„Éº„Éó„Çí‰Ωø„ÅÜ", xp: 40 },
                    { id: "pattern", desc: "Âõ≥ÂΩ¢„Éë„Çø„Éº„É≥„ÇíÊèè„Åè", xp: 35 },
                    { id: "sum", desc: "ÂêàË®à„ÇíË®àÁÆó„Åô„Çã", xp: 25 }
                ]
            }
        ];

        // PythonÂÆüË°å„Ç®„É≥„Ç∏„É≥ÔºàÊì¨‰ººÔºâ
        class PythonSimulator {
            constructor() {
                this.variables = {};
                this.output = [];
                this.inputQueue = [];
            }

            execute(code) {
                this.output = [];
                this.variables = {};
                const lines = code.split('\n');
                
                try {
                    for (let i = 0; i < lines.length; i++) {
                        this.executeLine(lines[i].trim(), i + 1);
                    }
                    return { success: true, output: this.output.join('\n') };
                } catch (error) {
                    return { success: false, error: error.message, line: error.line };
                }
            }

            executeLine(line, lineNumber) {
                // „Ç≥„É°„É≥„Éà„ÇÑÁ©∫Ë°å„Çí„Çπ„Ç≠„ÉÉ„Éó
                if (!line || line.startsWith('#')) return;

                // Â§âÊï∞‰ª£ÂÖ•
                if (line.includes('=') && !line.includes('==')) {
                    const [varName, value] = line.split('=').map(s => s.trim());
                    
                    // Á©∫Ê¨Ñ„ÉÅ„Çß„ÉÉ„ÇØ
                    if (value.includes('___')) {
                        throw { message: `Á©∫Ê¨Ñ„Åå„ÅÇ„Çä„Åæ„Åô`, line: lineNumber };
                    }
                    
                    // Êï∞ÂÄ§„É™„ÉÜ„É©„É´
                    if (/^\d+$/.test(value)) {
                        this.variables[varName] = parseInt(value);
                        this.updateMemoryVisualization(varName, value);
                    }
                    // ÊñáÂ≠óÂàó„É™„ÉÜ„É©„É´
                    else if (value.startsWith('"') || value.startsWith("'")) {
                        this.variables[varName] = value.slice(1, -1);
                        this.updateMemoryVisualization(varName, value);
                    }
                    // Â§âÊï∞ÂèÇÁÖß
                    else if (this.variables[value]) {
                        this.variables[varName] = this.variables[value];
                        this.updateMemoryVisualization(varName, this.variables[value]);
                    }
                    // ÊºîÁÆó
                    else if (value.includes('+') || value.includes('-') || value.includes('*') || value.includes('/')) {
                        const result = this.evaluateExpression(value);
                        this.variables[varName] = result;
                        this.updateMemoryVisualization(varName, result);
                    }
                    // inputÈñ¢Êï∞
                    else if (value.startsWith('input(')) {
                        const prompt = value.match(/input\((.*?)\)/)[1].replace(/['"]/g, '');
                        const inputValue = this.inputQueue.shift() || "„ÉÜ„Çπ„ÉàÂÖ•Âäõ";
                        this.output.push(`${prompt} ${inputValue}`);
                        this.variables[varName] = inputValue;
                        this.updateMemoryVisualization(varName, inputValue);
                    }
                    // intÈñ¢Êï∞
                    else if (value.startsWith('int(')) {
                        const varToConvert = value.match(/int\((.*?)\)/)[1];
                        const val = this.variables[varToConvert] || varToConvert;
                        this.variables[varName] = parseInt(val) || 0;
                        this.updateMemoryVisualization(varName, this.variables[varName]);
                    }
                }
                // printÊñá
                else if (line.startsWith('print(')) {
                    const content = line.match(/print\((.*)\)/)[1];
                    const output = this.evaluatePrintContent(content);
                    this.output.push(output);
                }
                // ifÊñá
                else if (line.startsWith('if ')) {
                    // Á∞°Áï•Âåñ„Åï„Çå„ÅüÊù°‰ª∂Ë©ï‰æ°
                    const condition = line.slice(3, -1);
                    // „Åì„Åì„Åß„ÅØÂçòÁ¥îÂåñ„ÅÆ„Åü„ÇÅ„ÄÅÂ∏∏„Å´Êù°‰ª∂„Çítrue„Å®„Åó„Å¶Êâ±„ÅÜ
                }
                // „Åù„ÅÆ‰ªñ„ÅÆÊßãÊñá„ÉÅ„Çß„ÉÉ„ÇØ
                else if (line.includes('___')) {
                    throw { message: `Á©∫Ê¨Ñ„Åå„ÅÇ„Çä„Åæ„Åô`, line: lineNumber };
                }
            }

            evaluateExpression(expr) {
                // Á∞°Âçò„Å™ÊºîÁÆó„ÇíË©ï‰æ°
                const parts = expr.split(/([+\-*/])/);
                let result = this.getValue(parts[0].trim());
                
                for (let i = 1; i < parts.length; i += 2) {
                    const operator = parts[i];
                    const value = this.getValue(parts[i + 1].trim());
                    
                    switch (operator) {
                        case '+': result += value; break;
                        case '-': result -= value; break;
                        case '*': result *= value; break;
                        case '/': result = Math.floor(result / value); break;
                    }
                }
                return result;
            }

            getValue(str) {
                if (/^\d+$/.test(str)) return parseInt(str);
                if (this.variables[str] !== undefined) return this.variables[str];
                return str;
            }

            evaluatePrintContent(content) {
                const parts = content.split(',').map(p => p.trim());
                const output = [];
                
                for (const part of parts) {
                    if (part.startsWith('"') || part.startsWith("'")) {
                        output.push(part.slice(1, -1));
                    } else if (this.variables[part] !== undefined) {
                        output.push(this.variables[part]);
                    } else if (/^\d+$/.test(part)) {
                        output.push(part);
                    } else {
                        output.push(this.evaluateExpression(part));
                    }
                }
                
                return output.join(' ');
            }

            updateMemoryVisualization(varName, value) {
                const memViz = document.getElementById('memoryViz');
                let box = document.getElementById(`mem-${varName}`);
                
                if (!box) {
                    box = document.createElement('div');
                    box.className = 'memory-box';
                    box.id = `mem-${varName}`;
                    box.innerHTML = `
                        <div class="var-name">${varName}</div>
                        <div class="var-value">${value}</div>
                    `;
                    memViz.appendChild(box);
                } else {
                    box.querySelector('.var-value').textContent = value;
                    box.classList.add('highlight');
                    setTimeout(() => box.classList.remove('highlight'), 500);
                }
            }

            setInputQueue(inputs) {
                this.inputQueue = inputs;
            }
        }

        const pythonSim = new PythonSimulator();

        // ÂàùÊúüÂåñ
        function init() {
            loadProgress();
            loadLesson(0);
            updateLineNumbers();
            updateStats();
            
            // „Ç®„Éá„Ç£„Çø„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
            const codeEditor = document.getElementById('codeEditor');
            codeEditor.addEventListener('input', updateLineNumbers);
            codeEditor.addEventListener('scroll', syncLineNumbers);
            codeEditor.addEventListener('keydown', updateLineNumbers);
            codeEditor.addEventListener('paste', () => setTimeout(updateLineNumbers, 0));
            
            // „ÉÅ„É£„Éó„Çø„Éº„É™„Çπ„Éà„ÅÆ„Ç§„Éô„É≥„Éà
            document.getElementById('chapterList').addEventListener('click', (e) => {
                const item = e.target.closest('.chapter-item');
                if (!item || item.classList.contains('locked')) return;
                
                document.querySelectorAll('.chapter-item').forEach(ch => {
                    ch.classList.remove('active');
                });
                item.classList.add('active');
                
                const chapter = parseInt(item.dataset.chapter);
                if (lessons[chapter]) {
                    loadLesson(chapter);
                }
            });
            
            // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        runCode();
                    } else if (e.key === 's') {
                        e.preventDefault();
                        saveProgress();
                    }
                }
            });
            
            // ÂÆöÊúü‰øùÂ≠ò
            setInterval(saveProgress, 30000);
            
            // Â≠¶ÁøíÊôÇÈñì„Ç´„Ç¶„É≥„Éà
            setInterval(() => {
                userProgress.totalTime++;
                document.getElementById('totalTime').textContent = userProgress.totalTime;
            }, 60000);
        }

        // „É¨„ÉÉ„Çπ„É≥Ë™≠„ÅøËæº„Åø
        function loadLesson(lessonId) {
            const lesson = lessons[lessonId];
            if (!lesson) return;
            
            currentLesson = lessonId;
            
            // UIÊõ¥Êñ∞
            document.getElementById('lessonTitle').textContent = `üìö ${lesson.title}`;
            document.getElementById('scratchCode').textContent = lesson.scratch;
            document.getElementById('pythonCode').textContent = lesson.python;
            
            // Èõ£ÊòìÂ∫¶Ë°®Á§∫
            const stars = document.querySelectorAll('.difficulty-star');
            stars.forEach((star, index) => {
                star.classList.toggle('active', index < lesson.difficulty);
            });
            
            // „Ç®„Éá„Ç£„ÇøÊõ¥Êñ∞
            if (currentTab === 'practice') {
                document.getElementById('codeEditor').value = lesson.practice;
            }
            
            // „ÉÅ„É£„É¨„É≥„Ç∏„É™„Çπ„ÉàÊõ¥Êñ∞
            const challengeList = document.getElementById('challengeList');
            challengeList.innerHTML = lesson.challenges.map(ch => `
                <li class="challenge-item" id="challenge-${ch.id}" onclick="checkChallenge('${ch.id}')">
                    <span>${ch.desc}</span>
                    <span>+${ch.xp} XP</span>
                </li>
            `).join('');
            
            // „É°„É¢„É™ÂèØË¶ñÂåñ„É™„Çª„ÉÉ„Éà
            document.getElementById('memoryViz').innerHTML = '';
            
            // Âá∫Âäõ„É™„Çª„ÉÉ„Éà
            document.getElementById('output').textContent = 'ÂÆüË°åÁµêÊûú„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô...';
            document.getElementById('testCases').style.display = 'none';
            
            updateLineNumbers();
        }

        // „Çø„ÉñÂàá„ÇäÊõø„Åà
        function switchTab(tab) {
            currentTab = tab;
            const lesson = lessons[currentLesson];
            const editor = document.getElementById('codeEditor');
            
            // „Çø„Éñ„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖãÊõ¥Êñ∞
            document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            switch (tab) {
                case 'practice':
                    editor.value = lesson.practice;
                    break;
                case 'solution':
                    editor.value = lesson.solution;
                    updateProgress(5);
                    break;
                case 'sandbox':
                    editor.value = '# Ëá™Áî±„Å´„Ç≥„Éº„Éâ„ÇíÊõ∏„ÅÑ„Å¶„Åø„Çà„ÅÜÔºÅ\n\n';
                    break;
            }
            
            updateLineNumbers();
        }

        // „Ç≥„Éº„ÉâÂÆüË°å
        function runCode() {
            const code = document.getElementById('codeEditor').value;
            const outputDiv = document.getElementById('output');
            
            // „ÉÜ„Çπ„ÉàÁî®„ÅÆÂÖ•Âäõ„ÇíË®≠ÂÆö
            pythonSim.setInputQueue(['Â§™ÈÉé', '13']);
            
            // „É°„É¢„É™ÂèØË¶ñÂåñ„Çí„ÇØ„É™„Ç¢
            document.getElementById('memoryViz').innerHTML = '';
            
            const result = pythonSim.execute(code);
            
            if (result.success) {
                outputDiv.classList.remove('error');
                outputDiv.innerHTML = result.output.split('\n').map(line => 
                    `<div class="output-line">${line}</div>`
                ).join('');
                
                updateProgress(10);
                checkChallenges(code);
                
                // ÂàùÂõûÂÆüË°å„ÅÆÂÆüÁ∏æ
                if (!userProgress.achievements.includes('first_run')) {
                    userProgress.achievements.push('first_run');
                    showAchievement('Âàù„ÇÅ„Å¶„ÅÆÂÆüË°å', '„Éó„É≠„Ç∞„É©„É†„ÇíÂÆüË°å„Åó„Åæ„Åó„ÅüÔºÅ', 20);
                }
            } else {
                outputDiv.classList.add('error');
                outputDiv.textContent = `„Ç®„É©„Éº (${result.line}Ë°åÁõÆ): ${result.error}`;
                
                // „Ç®„É©„ÉºËß£Ê±∫„Ç´„Ç¶„É≥„Éà
                if (code.includes('___') === false) {
                    userProgress.errorsSolved++;
                    document.getElementById('errorsSolved').textContent = userProgress.errorsSolved;
                }
            }
        }

        // „Çπ„ÉÜ„ÉÉ„ÉóÂÆüË°å
        function stepDebug() {
            const debugPanel = document.getElementById('debugPanel');
            const debugOutput = document.getElementById('debugOutput');
            debugPanel.style.display = 'block';
            
            const code = document.getElementById('codeEditor').value;
            const lines = code.split('\n').filter(line => line.trim() && !line.trim().startsWith('#'));
            
            debugOutput.innerHTML = '';
            
            lines.forEach((line, index) => {
                setTimeout(() => {
                    const debugLine = document.createElement('div');
                    debugLine.className = 'debug-line step';
                    debugLine.textContent = `„Çπ„ÉÜ„ÉÉ„Éó ${index + 1}: ${line}`;
                    debugOutput.appendChild(debugLine);
                    debugOutput.scrollTop = debugOutput.scrollHeight;
                }, index * 500);
            });
        }

        // „Ç≥„Éº„Éâ„ÉÅ„Çß„ÉÉ„ÇØ
        function checkCode() {
            const code = document.getElementById('codeEditor').value;
            const lesson = lessons[currentLesson];
            
            const testCases = document.getElementById('testCases');
            const testResults = document.getElementById('testResults');
            testCases.style.display = 'block';
            
            const tests = [
                { name: 'Á©∫Ê¨Ñ„ÉÅ„Çß„ÉÉ„ÇØ', pass: !code.includes('___') },
                { name: 'ÊßãÊñá„ÉÅ„Çß„ÉÉ„ÇØ', pass: checkSyntax(code) },
                { name: 'Âá∫Âäõ„ÉÅ„Çß„ÉÉ„ÇØ', pass: checkOutput(code, lesson.expectedOutput) }
            ];
            
            testResults.innerHTML = tests.map(test => `
                <div class="test-case ${test.pass ? 'pass' : 'fail'}">
                    <span>${test.pass ? '‚úÖ' : '‚ùå'} ${test.name}</span>
                </div>
            `).join('');
            
            if (tests.every(t => t.pass)) {
                markLessonComplete(currentLesson);
                showAchievement('ÂÆåÁíßÔºÅ', `${lesson.title}„Çí„ÇØ„É™„Ç¢ÔºÅ`, 50);
            }
        }

        // ÊßãÊñá„ÉÅ„Çß„ÉÉ„ÇØÔºàÁ∞°ÊòìÁâàÔºâ
        function checkSyntax(code) {
            const lines = code.split('\n');
            for (const line of lines) {
                if (line.includes('___')) return false;
                if (line.trim().startsWith('if') && !line.endsWith(':')) return false;
                if (line.trim().startsWith('for') && !line.endsWith(':')) return false;
                if (line.trim().startsWith('elif') && !line.endsWith(':')) return false;
                if (line.trim().startsWith('else') && !line.endsWith(':')) return false;
            }
            return true;
        }

        // Âá∫Âäõ„ÉÅ„Çß„ÉÉ„ÇØÔºàÁ∞°ÊòìÁâàÔºâ
        function checkOutput(code, expected) {
            // ÂÆüÈöõ„ÅÆÂÆüË£Ö„Åß„ÅØ„ÄÅÂÆüË°åÁµêÊûú„Å®ÊúüÂæÖÂÄ§„ÇíÊØîËºÉ
            return !code.includes('___');
        }

        // „É™„Çª„ÉÉ„Éà
        function resetCode() {
            const lesson = lessons[currentLesson];
            document.getElementById('codeEditor').value = lesson.practice;
            document.getElementById('output').textContent = 'ÂÆüË°åÁµêÊûú„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô...';
            document.getElementById('testCases').style.display = 'none';
            document.getElementById('debugPanel').style.display = 'none';
            document.getElementById('memoryViz').innerHTML = '';
            document.getElementById('hintContent').classList.remove('show');
            document.querySelectorAll('.hint-button').forEach(btn => {
                btn.classList.remove('revealed');
            });
            updateLineNumbers();
        }

        // „Éí„É≥„ÉàË°®Á§∫
        function showHint(level) {
            const lesson = lessons[currentLesson];
            const hintContent = document.getElementById('hintContent');
            const hintButton = event.target;
            
            hintButton.classList.add('revealed');
            hintContent.innerHTML = `<strong>„Éí„É≥„Éà${level}:</strong><br>${lesson.hints[level - 1]}`;
            hintContent.classList.add('show');
            
            // „Éí„É≥„Éà‰ΩøÁî®„ÅßXPÊ∏õÂ∞ë
            if (level === 3) {
                updateProgress(-5);
            }
        }

        // „ÉÅ„É£„É¨„É≥„Ç∏„ÉÅ„Çß„ÉÉ„ÇØ
        function checkChallenges(code) {
            const lesson = lessons[currentLesson];
            
            // Â§âÊï∞„Ç´„Ç¶„É≥„Éà
            const varCount = (code.match(/^\s*\w+\s*=/gm) || []).length;
            if (varCount >= 3) {
                completeChallenge('var3');
            }
            
            // „Ç®„É©„Éº„Å™„ÅóÂÆüË°å
            if (!code.includes('___')) {
                completeChallenge('noerror');
            }
        }

        // „ÉÅ„É£„É¨„É≥„Ç∏ÂÆå‰∫Ü
        function completeChallenge(challengeId) {
            const element = document.getElementById(`challenge-${challengeId}`);
            if (element && !element.classList.contains('completed')) {
                element.classList.add('completed');
                const lesson = lessons[currentLesson];
                const challenge = lesson.challenges.find(c => c.id === challengeId);
                if (challenge) {
                    updateProgress(challenge.xp);
                }
            }
        }

        // „É¨„ÉÉ„Çπ„É≥ÂÆå‰∫Ü
        function markLessonComplete(lessonId) {
            if (!userProgress.completedLessons.includes(lessonId)) {
                userProgress.completedLessons.push(lessonId);
                
                // UI„ÇíÊõ¥Êñ∞
                const chapterItem = document.querySelector(`.chapter-item[data-chapter="${lessonId}"]`);
                if (chapterItem) {
                    chapterItem.classList.add('completed');
                }
                
                // Ê¨°„ÅÆ„ÉÅ„É£„Éó„Çø„Éº„Çí„Ç¢„É≥„É≠„ÉÉ„ÇØ
                const nextChapter = document.querySelector(`.chapter-item[data-chapter="${lessonId + 1}"]`);
                if (nextChapter) {
                    nextChapter.classList.remove('locked');
                }
                
                updateStats();
                updateProgress(100);
            }
        }

        // ÈÄ≤ÊçóÊõ¥Êñ∞
        function updateProgress(xp) {
            userProgress.xp += xp;
            
            // „É¨„Éô„É´„Ç¢„ÉÉ„Éó„ÉÅ„Çß„ÉÉ„ÇØ
            while (userProgress.xp >= userProgress.requiredXP) {
                userProgress.xp -= userProgress.requiredXP;
                userProgress.level++;
                userProgress.requiredXP = userProgress.level * 100;
                showAchievement('„É¨„Éô„É´„Ç¢„ÉÉ„ÉóÔºÅ', `„É¨„Éô„É´${userProgress.level}„Å´Âà∞ÈÅîÔºÅ`, 0);
            }
            
            // „Éû„Ç§„Éä„ÇπXP„ÅÆÂá¶ÁêÜ
            if (userProgress.xp < 0) {
                userProgress.xp = 0;
            }
            
            // UIÊõ¥Êñ∞
            document.getElementById('userLevel').textContent = userProgress.level;
            document.getElementById('currentXP').textContent = Math.floor(userProgress.xp);
            document.getElementById('requiredXP').textContent = userProgress.requiredXP;
            document.getElementById('xpProgress').style.width = `${(userProgress.xp / userProgress.requiredXP) * 100}%`;
            
            saveProgress();
        }

        // Áµ±Ë®àÊõ¥Êñ∞
        function updateStats() {
            document.getElementById('completedCount').textContent = userProgress.completedLessons.length;
            document.getElementById('streakCount').textContent = userProgress.streak;
            document.getElementById('totalTime').textContent = userProgress.totalTime;
            document.getElementById('errorsSolved').textContent = userProgress.errorsSolved;
        }

        // ÂÆüÁ∏æË°®Á§∫
        function showAchievement(title, description, xp) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementTitle').textContent = title;
            document.getElementById('achievementDesc').textContent = description;
            document.getElementById('achievementXP').textContent = xp > 0 ? `+${xp} XP` : '';
            
            popup.classList.add('show');
            
            if (xp > 0) {
                updateProgress(xp);
            }
            
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }

        // ÂÆüÁ∏æ„ÇíÈñâ„Åò„Çã
        function closeAchievement() {
            document.getElementById('achievementPopup').classList.remove('show');
        }

        // Ë°åÁï™Âè∑Êõ¥Êñ∞
        function updateLineNumbers() {
            const editor = document.getElementById('codeEditor');
            const lineNumbers = document.getElementById('lineNumbers');
            const lines = editor.value.split('\n').length;
            
            lineNumbers.textContent = Array.from({length: lines}, (_, i) => i + 1).join('\n');
            
            // È´ò„Åï„ÇíÂêåÊúü
            lineNumbers.style.height = editor.scrollHeight + 'px';
        }

        // Ë°åÁï™Âè∑„Çπ„ÇØ„É≠„Éº„É´ÂêåÊúü
        function syncLineNumbers() {
            const editor = document.getElementById('codeEditor');
            const lineNumbers = document.getElementById('lineNumbers');
            lineNumbers.scrollTop = editor.scrollTop;
        }

        // ÈÄ≤Êçó‰øùÂ≠ò
        function saveProgress() {
            localStorage.setItem('pythonGameProgress', JSON.stringify(userProgress));
        }

        // ÈÄ≤ÊçóË™≠„ÅøËæº„Åø
        function loadProgress() {
            const saved = localStorage.getItem('pythonGameProgress');
            if (saved) {
                userProgress = JSON.parse(saved);
                updateProgress(0);
                updateStats();
                
                // ÂÆå‰∫Ü„É¨„ÉÉ„Çπ„É≥„ÅÆË°®Á§∫„ÇíÊõ¥Êñ∞
                userProgress.completedLessons.forEach(lessonId => {
                    const chapterItem = document.querySelector(`.chapter-item[data-chapter="${lessonId}"]`);
                    if (chapterItem) {
                        chapterItem.classList.add('completed');
                    }
                    const nextChapter = document.querySelector(`.chapter-item[data-chapter="${lessonId + 1}"]`);
                    if (nextChapter) {
                        nextChapter.classList.remove('locked');
                    }
                });
            }
        }

        // ÂàùÊúüÂåñÂÆüË°å
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>